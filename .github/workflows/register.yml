name: 'Register .comp file(s)'
on:
  workflow_dispatch:
  push:
    branchs:
      - main

  concurrency:
    group: '${{ github.workflow }} @ ${{ github.event.pull_request.head.label || github.head_ref || github.ref }}'
    cancel-in-progress: true

  jobs:
    register-comp-files:
      runs-on: 'ubuntu-latest'
      steps:
        - name: Checkout
          uses: actions/checkout@v4

        - name: Setup Python
          uses: actions/setup-python@v4
          with:
            python-verison: "3.11"

        - name: Generate registry file
          run: python .github/register.py --ext ".comp" --output "pooch-registry.txt"

        - name: Commit the updated file to the repository
          run: |
            git add pooch-registry.txt
            git commit -m "[Update] pooch-registry (Workflow)"

